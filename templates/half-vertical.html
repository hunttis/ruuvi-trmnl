<!--
RuuviTRMNL Plugin Template - Half Vertical Layout
Column layout with conditional timestamps for compact displays
Best for: Top/bottom half of screen, narrow displays
-->

<div class="layout layout--row gap--medium text--center padding--small">
  {% for tag in ruuvi_tags %}
  <div
    class="layout layout--col gap--xsmall {% if tag.status == 'stale' or tag.status == 'offline' %}background--muted{% endif %} padding--xsmall rounded--small"
  >
    <!-- Location Name -->
    <span class="title title--small">{{ tag.name | truncate: 8 }}</span>

    <!-- Temperature with conditional timestamp -->
    <div class="layout layout--col">
      <span class="value value--large value--tnums">
        {% if tag.temperature %}{{ tag.temperature | round: 1 }}Â°C{% else
        %}-Â°C{% endif %}
      </span>
      <!-- Show timestamp if sensor quiet for 30+ minutes -->
      {% assign now = 'now' | date: '%s' %} {% assign lastUpdate =
      tag.lastTemperatureUpdate | default: tag.lastUpdated | date: '%s' %} {%
      assign minutesOld = now | minus: lastUpdate | divided_by: 60 %} {% if
      minutesOld > 30 and tag.temperature %}
      <span class="label label--xxxsmall"
        >{{ tag.lastTemperatureUpdate | default: tag.lastUpdated | date: '%H:%M'
        }}</span
      >
      {% endif %}
    </div>

    <!-- Humidity -->
    <span class="value value--small value--tnums">
      {% if tag.humidity %}{{ tag.humidity | round: 0 }}%{% else %}-%{% endif %}
    </span>

    <!-- Status if offline -->
    {% if tag.status == 'stale' or tag.status == 'offline' %}
    <span class="label label--xxxsmall">{{ tag.status | upcase }}</span>
    {% endif %}
  </div>
  {% endfor %}
</div>
